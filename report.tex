% ----------
% A LaTeX template for course project reports
% 
% This template is modified from "Tech Report ala MIT AI Lab (1981)"
% 
% ----------
\documentclass[12pt, letterpaper, twoside]{article}
\usepackage{geometry}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage[runin]{abstract}
\usepackage{titling}
\usepackage{booktabs}
\usepackage{fancyhdr}
\usepackage{helvet}
\usepackage{csquotes}
\usepackage{graphicx}
\usepackage{blindtext}
\usepackage{parskip}
\usepackage{etoolbox}


\input{preamble.tex}

% ----------
% Variables
% ----------

\title{\textbf{Helping Municipalities Maintain Roads by Locating Defects Using Computer Vision}} % Full title of your tech report
\runningtitle{Detecting Road Defects Using Computer Vision} % Short title
\author{Samuel Bazinet} % Full list of authors
\runningauthor{Samuel Bazinet} % Short list of authors
\affiliation{Ontario Tech University} % Affiliation e.g. University or Company
\department{Faculty of Science, Computer Science} % Department or Office
\memoid{Project} % Project group ID that were shared with the class earlier.
\theyear{2024} % year of the tech report
\mydate{April 5, 2024} %the date


% ----------
% actual document
% ----------
\begin{document}
\maketitle

\begin{abstract}
    \noindent
    
    In a world where efficiency is more important than ever and with roads being built all the time,
    finding road defects needs to be as automated as possible to maintain a good driving experience for all citizens. 
    With computers getting faster by the year, 
    we can use this newfound ability to use them to help us automatically find defects such as potholes and cracks without human intervention.
    This paper looks over how we can setup such a system, 
    including finding an algorithm to find potential defects, 
    as well as training a machine learning model to differentiate between the types of defects.

    % Uncomment the following to add keywords as needed
    \keywords{Computer Vision, Infrastructure}
\end{abstract}

\vspace{2.5cm}

% Uncomment the following to add thanks.
% {\footnotesize
%     \noindent
%     Special thanks to \textbf{Person 1} and \textbf{Affiliation A} for financial support for this project.
% }

\thispagestyle{firstpage}

\pagebreak

% ----------
% End of first page
% ----------

\newgeometry{} % Redefine geometries (normal margins)

\section{Introduction}
\label{sec:intro}

This course on computer vision started with a lab where stop signs had to be identified on an image. 
This was relatively simple as stop signs are standardized so they can be easily identified. 
Unfortunately, the same cannot be said for road defects. 
We cannot simply use a single default template and expect to get a substantial true match rate. 
This means that a substantial amount of work needs to take place in order to be able to outline the potential defects on the road.
This paper will go over the efforts required to get a relatively competent model to detect defects on an image of a road. 

\section{Methodology}
\label{sec:meth}

Detecting defects on a road is a somewhat complex procedure involving many steps to get the model going. 
As we are trying to find cracks and potholes, we cannot use simple apttern matching as they very a lot in size, color, and pattern.
We need a trained model for this.
This methodology will go over them.

\subsection{Finding Potential Defects}

The first part of finding defects on road is to scan the image for potential defects. 
Cracks and potholes tend to be very well defined on roads, meaning that Canny edge detection is great way to find them.
But since roads can contain many edges, a blurring filter is ran beforehands to reduce the noise in the resulting edges.
Then, the program scans the image and groups the edges into their own objects so that we can extract the potential defects as their own images for later usage.
To make this easier, a dataclass called `Defect', containing the coordinates of each corner as well as a list of pixels of where the edge as detected, was created. 
This class has a few helepr methods to merge potential defects contained within each other as the assumption was made that they would be part of the same defect.
It also has a method to ``recenter'' itself around the densest collection of edges for the purpose of training the model with evenly sized images.
50 images were ran through this ``potential defect extractor'' to collect hundreds of potential defects that could be used for trianing the model that will be used to detect the real defects.

\subsection{Training a Model to Classify the Defects}

There are 3 classes that will be used by the model: crack, pothole, and non-defect. 
To train the model, the images of the potential defects generated by the last step have been manually classified into 3 folders, one for each class.
Keras and TensorFlow were used to train the model as they were easy to use and have plenty of online resources for extra help.
The model consists of 7 layers consisting of rescaling, 2D convolutions, pooling, flattening, and dense.
The data was augmenting using the Keras sequential augmenter, where the data set had images copied with different rotation and zoom levels.
This is quite useful as generating more images for training is very time consuming.
The model was trained over 100 epochs, where the training accuracy went from low 30\% to around 80\%,
and the validation accuracy reached 70\%.
The model was saved for access by the actual defect identifier.

\subsection{Applying the model to potential defects and highlighting them on an image}

Using the same method as defined in Section 2.1, we find potential defects, then pass them through the model.
Using the prediction from the model, we draw a red line around predicted potholes, and a green line around predicted cracks.
Non defects are not highlighted.
This results into an image where the defects are highlighted so that municipalities and whoever need the data will get to use it.

\section{Results}
\label{sec:resu}



\section{Discussion and Conclusions}
\label{sec:conc}


% Uncomment following to add an acknowledgement section
% \section*{Acknowledgements}

% Thanks again to \textbf{Person 1} and \textbf{Affiliation A} for their financial support.

% ----------
% Bibliography
% ----------

% Uncomment the following and add your references into biblio.bib file
% \bibliography{./biblio.bib}
% \bibliographystyle{abbrv}

\appendix

\section{Sample images used in training the model}

\section{Model training statistics}

\section{Sample resulting images}


\end{document}

% ----------